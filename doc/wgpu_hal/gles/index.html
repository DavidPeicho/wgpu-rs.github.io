<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="GLES API internals."><meta name="keywords" content="rust, rustlang, rust-lang, gles"><title>wgpu_hal::gles - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Regular-1f7d512b176f0f72.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Regular-018c141bf0843ffd.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/FiraSans-Medium-8f9a781e4970d388.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceSerif4-Bold-124a1ca42af929b6.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2"><link rel="stylesheet" href="../../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../../static.files/rustdoc-6d262342be62306e.css" id="mainThemeStyle"><link rel="stylesheet" id="themeStyle" href="../../static.files/light-5f7299aa2b503fb1.css"><link rel="stylesheet" disabled href="../../static.files/dark-dfb18ef8114bb428.css"><link rel="stylesheet" disabled href="../../static.files/ayu-4047a6aaddd3789d.css"><script id="default-settings" ></script><script src="../../static.files/storage-d43fa987303ecbbb.js"></script><script defer src="../../static.files/main-3367e395607fafc1.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-13285aec31fa243e.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-16x16-8b506e7a72182f1c.png"><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="logo-container" href="../../wgpu_hal/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2></h2></nav><nav class="sidebar"><a class="logo-container" href="../../wgpu_hal/index.html"><img class="rust-logo" src="../../static.files/rust-logo-151179464ae7ed46.svg" alt="logo"></a><h2 class="location"><a href="#">Module gles</a></h2><div class="sidebar-elems"><section><ul class="block"><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li></ul></section></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" aria-label="Run search in the documentation" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../static.files/wheel-5ec35bf9ca753509.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1>Module <a href="../index.html">wgpu_hal</a>::<wbr><a class="mod" href="#">gles</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../static.files/clipboard-7571035ce49a181d.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../src/wgpu_hal/gles/mod.rs.html#1-872">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><span class="item-info"><div class="stab portability">Available on <strong>crate feature <code>gles</code></strong> only.</div></span><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>GLES API internals.</p>
<h2 id="opengl-es3-api-aka-gles3"><a href="#opengl-es3-api-aka-gles3">OpenGL ES3 API (aka GLES3).</a></h2>
<p>Designed to work on Linux and Android, with context provided by EGL.</p>
<h3 id="texture-views"><a href="#texture-views">Texture views</a></h3>
<p>GLES3 doesn’t really have separate texture view objects. We have to remember the
original texture and the sub-range into it. Problem is, however, that there is
no way to expose a subset of array layers or mip levels of a sampled texture.</p>
<h3 id="binding-model"><a href="#binding-model">Binding model</a></h3>
<p>Binding model is very different from WebGPU, especially with regards to samplers.
GLES3 has sampler objects, but they aren’t separately bindable to the shaders.
Each sampled texture is exposed to the shader as a combined texture-sampler binding.</p>
<p>When building the pipeline layout, we linearize binding entries based on the groups
(uniform/storage buffers, uniform/storage textures), and record the mapping into
<code>BindGroupLayoutInfo</code>.
When a pipeline gets created, and we track all the texture-sampler associations
from the static use in the shader.
We only support at most one sampler used with each texture so far. The linear index
of this sampler is stored per texture slot in <code>SamplerBindMap</code> array.</p>
<p>The texture-sampler pairs get potentially invalidated in 2 places:</p>
<ul>
<li>when a new pipeline is set, we update the linear indices of associated samplers</li>
<li>when a new bind group is set, we update both the textures and the samplers</li>
</ul>
<p>We expect that the changes to sampler states between any 2 pipelines of the same layout
will be minimal, if any.</p>
<h3 id="vertex-data"><a href="#vertex-data">Vertex data</a></h3>
<p>Generally, vertex buffers are marked as dirty and lazily bound on draw.</p>
<p>GLES3 doesn’t support “base instance” semantics. However, it’s easy to support,
since we are forced to do late binding anyway. We just adjust the offsets
into the vertex data.</p>
<h4 id="old-path"><a href="#old-path">Old path</a></h4>
<p>In GLES-3.0 and WebGL2, vertex buffer layout is provided
together with the actual buffer binding.
We invalidate the attributes on the vertex buffer change, and re-bind them.</p>
<h4 id="new-path"><a href="#new-path">New path</a></h4>
<p>In GLES-3.1 and higher, the vertex buffer layout can be declared separately
from the vertex data itself. This mostly matches WebGPU, however there is a catch:
<code>stride</code> needs to be specified with the data, not as a part of the layout.</p>
<p>To address this, we invalidate the vertex buffers based on:</p>
<ul>
<li>whether or not <code>start_instance</code> is used</li>
<li>stride has changed</li>
</ul>
</div></details><h2 id="structs" class="small-section-header"><a href="#structs">Structs</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Adapter.html" title="wgpu_hal::gles::Adapter struct">Adapter</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.AdapterContext.html" title="wgpu_hal::gles::AdapterContext struct">AdapterContext</a><span class="stab portability" title="Available on non-WebAssembly or crate feature `emscripten` only">Non-WebAssembly or <code>emscripten</code></span></div><div class="item-right docblock-short">A wrapper around a [<code>glow::Context</code>] and the required EGL context that uses locking to guarantee
exclusive access when shared with multiple threads.</div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.AdapterContextLock.html" title="wgpu_hal::gles::AdapterContextLock struct">AdapterContextLock</a><span class="stab portability" title="Available on non-WebAssembly or crate feature `emscripten` only">Non-WebAssembly or <code>emscripten</code></span></div><div class="item-right docblock-short">A guard containing a lock to an <a href="struct.AdapterContext.html" title="AdapterContext"><code>AdapterContext</code></a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Api.html" title="wgpu_hal::gles::Api struct">Api</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.BindGroup.html" title="wgpu_hal::gles::BindGroup struct">BindGroup</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.BindGroupLayout.html" title="wgpu_hal::gles::BindGroupLayout struct">BindGroupLayout</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Buffer.html" title="wgpu_hal::gles::Buffer struct">Buffer</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CommandBuffer.html" title="wgpu_hal::gles::CommandBuffer struct">CommandBuffer</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.CommandEncoder.html" title="wgpu_hal::gles::CommandEncoder struct">CommandEncoder</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ComputePipeline.html" title="wgpu_hal::gles::ComputePipeline struct">ComputePipeline</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Device.html" title="wgpu_hal::gles::Device struct">Device</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Fence.html" title="wgpu_hal::gles::Fence struct">Fence</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.PipelineLayout.html" title="wgpu_hal::gles::PipelineLayout struct">PipelineLayout</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.QuerySet.html" title="wgpu_hal::gles::QuerySet struct">QuerySet</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Queue.html" title="wgpu_hal::gles::Queue struct">Queue</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.RenderPipeline.html" title="wgpu_hal::gles::RenderPipeline struct">RenderPipeline</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Sampler.html" title="wgpu_hal::gles::Sampler struct">Sampler</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.ShaderModule.html" title="wgpu_hal::gles::ShaderModule struct">ShaderModule</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.Texture.html" title="wgpu_hal::gles::Texture struct">Texture</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.TextureFormatDesc.html" title="wgpu_hal::gles::TextureFormatDesc struct">TextureFormatDesc</a></div></div><div class="item-row"><div class="item-left module-item"><a class="struct" href="struct.TextureView.html" title="wgpu_hal::gles::TextureView struct">TextureView</a></div></div></div><h2 id="enums" class="small-section-header"><a href="#enums">Enums</a></h2><div class="item-table"><div class="item-row"><div class="item-left module-item"><a class="enum" href="enum.TextureInner.html" title="wgpu_hal::gles::TextureInner enum">TextureInner</a></div></div></div></section></div></main><div id="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="wgpu_hal" data-themes="" data-resource-suffix="" data-rustdoc-version="1.69.0-nightly (c8e6a9e8b 2023-01-23)" data-search-js="search-98d53477a794af0b.js" data-settings-js="settings-c3c521c753752a1a.js" data-settings-css="settings-08ddfdda51b8ee2e.css" ></div></body></html>